add-symbol-file ffffffff81000000
add-symbol-file ./memo.ko ffffffff81000000
q
q
add-symbol-file ./memo.ko 0xffffffffc069e000
add-symbol-file ./test/memo.ko 0xffffffffc069e000
target remote:1234
target remote:1234
c
r
q
add-symbol-file ./test/memo.ko 0xffffffffc069e000
r
q
q
exit
q
vmmap
p mod_write
p &mod_write
add-symbol-file ./test/memo.ko 0xffffffffc069e000
c
vmmap
p sizeof(tty_struct)
source /home/koharin/linux-4.19.98/
source /home/koharin/linux-4.19.98
p kfree
p system
directory /home/koharin/linux-4.19.98/
set follow-exec-mode new
c
p kfree
ni
heap
ni
fin
ni
p kfree
ni
q
directory /home/koharin/linux-4.19.98/
set follow-exec-mode new
vmmap
add-symbol-file ./test/memo.ko 0xffffffffc069e000
c
vmmap
x/x 0xfffb3a50fffb3d30
ni
heap
ni
fin
ni
heap
vmmap
shell cat /proc/sys/kernel/kptr_restrict
shell cat /proc/sys/kernel/dmesg_restrict
shell echo 1 >  /proc/sys/kernel/dmesg_restrict
shell sudo echo 1 >  /proc/sys/kernel/dmesg_restrict
q
target remote:1234
q
target remote:1234
target remote:1234
target remote : 1234
target remote : 1234
q
target remote:1234
q
